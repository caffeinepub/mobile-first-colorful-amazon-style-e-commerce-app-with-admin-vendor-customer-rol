{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Restore Vite/TS config and shim Internet Identity env for successful production builds",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Restore missing Vite + React + TypeScript production build configuration files so the frontend compiles in deployment.",
      "acceptanceCriteria": [
        "`frontend/vite.config.ts` exists and is valid for a Vite + React + TypeScript project.",
        "`frontend/tsconfig.json` exists and is valid for a Vite + React + TypeScript project.",
        "A production build completes without configuration-file-not-found errors (e.g., missing Vite/TS config)."
      ],
      "file_operations": [
        {
          "path": "frontend/vite.config.ts",
          "operation": "create",
          "description": "Create a Vite configuration for React + TypeScript builds, including React plugin setup and any required build defaults for deployment stability."
        },
        {
          "path": "frontend/tsconfig.json",
          "operation": "create",
          "description": "Create the root TypeScript config for the frontend with appropriate compilerOptions for a Vite + React app (including JSX, module resolution, and any needed path aliasing used by the codebase such as `@/*`)."
        },
        {
          "path": "frontend/tsconfig.node.json",
          "operation": "create",
          "description": "Add a Node-oriented TS config used by Vite tooling/config typing (to prevent deployment/build environments from failing when type-checking `vite.config.ts`)."
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Prevent `process.env.II_URL` browser-bundle failures by shimming/defining it at Vite build time (without editing immutable hook files).",
      "acceptanceCriteria": [
        "The production build does not fail with errors like `process is not defined` or missing `process.env` references.",
        "Internet Identity login still works in production builds using the configured identity provider URL.",
        "No changes are made to immutable paths (including `frontend/src/hooks/useInternetIdentity.ts`)."
      ],
      "file_operations": [
        {
          "path": "frontend/vite.config.ts",
          "operation": "modify",
          "description": "Update Vite config to define/shim `process.env.II_URL` at build time using a safe default (e.g., `https://identity.ic0.app`) and/or `import.meta.env.VITE_II_URL`, ensuring the bundle does not rely on a runtime `process` object."
        },
        {
          "path": "frontend/src/vite-env.d.ts",
          "operation": "modify",
          "description": "Ensure TypeScript environment variable typings include `VITE_II_URL` (and remain compatible with the Vite-based solution for selecting the Internet Identity provider URL)."
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Document build/deploy verification steps and required environment variables for a successful deployed frontend.",
      "acceptanceCriteria": [
        "A production build succeeds end-to-end.",
        "The deployed frontend loads in the browser without a blank screen or immediate runtime crash.",
        "`frontend/DEPLOYMENT.md` reflects the final, correct deployment prerequisites (including environment variables) if changes were required."
      ],
      "file_operations": [
        {
          "path": "frontend/DEPLOYMENT.md",
          "operation": "modify",
          "description": "Update deployment documentation to reflect the final fix approach (Vite-time shim for `process.env.II_URL` without changing immutable hooks), list required/optional environment variables (e.g., `VITE_II_URL`), and provide concise build + deploy verification steps to confirm the app loads successfully."
        }
      ]
    }
  ]
}